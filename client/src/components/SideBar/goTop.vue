<!--返回顶部-->
<template>
  <transition :name="transitionName">
    <div
      v-show="visible"
      :style="customStyle"
      class="back-to-ceiling"
      @click="goTop"
    >
      <svg t="1690344018552" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1182" width="60" height="60"><path d="M719.629038 736.150402m-287.832091 0a287.832091 287.832091 0 1 0 575.664183 0 287.832091 287.832091 0 1 0-575.664183 0Z" fill="#C3E49A" p-id="1183"></path><path d="M102.517034 323.33522a31.981343 31.981343 0 0 1 15.734821 42.407262A419.403338 419.403338 0 0 0 80.002169 541.38402c0 231.289076 186.131419 418.635786 415.757465 418.635786s415.757465-187.410673 415.757465-418.635786c0-61.340217-13.112351-120.69759-37.993836-175.129837a31.981343 31.981343 0 1 1 58.142082-26.67244c28.783209 62.747396 43.814441 131.251434 43.814441 201.802277 0 266.468554-214.72274 482.598473-479.720152 482.598473S16.039482 807.852574 16.039482 541.38402c0-70.742732 15.159157-139.438658 44.134254-202.377941a31.981343 31.981343 0 0 1 42.343298-15.670859zM495.759634 640.206372a31.981343 31.981343 0 0 1 31.981343 31.981343v191.888061a31.981343 31.981343 0 1 1-63.962687 0v-191.888061a31.981343 31.981343 0 0 1 31.981344-31.981343z m-95.944031 63.962687a31.981343 31.981343 0 0 1 31.981344 31.981343v63.962687a31.981343 31.981343 0 1 1-63.962687 0v-63.962687a31.981343 31.981343 0 0 1 31.981343-31.981343z m191.888061 0a31.981343 31.981343 0 0 1 31.981344 31.981343v63.962687a31.981343 31.981343 0 1 1-63.962687 0v-63.962687a31.981343 31.981343 0 0 1 31.981343-31.981343z m-95.304403-703.589557a31.853418 31.853418 0 0 1 22.642791 8.698925c99.334053 94.217038 145.834926 214.466889 138.990919 358.25501l-0.319814 4.797202c94.344963 98.182724 117.371531 229.306233 70.486881 388.957099l-5.436828 17.589739-0.255851 0.95944a32.173232 32.173232 0 0 1-1.726992 4.221538l-2.174732 3.837761a40.93612 40.93612 0 0 1-1.151328 1.535104l-1.599067 1.918881a33.900224 33.900224 0 0 1-6.588157 5.628716l-1.535105 0.959441a30.190388 30.190388 0 0 1-5.948529 2.558507l-2.942284 0.70359-4.477388 0.639627-4.157575 0.127925a30.766052 30.766052 0 0 1-3.965686-0.511702l-4.02965-0.95944a32.36512 32.36512 0 0 1-2.814358-1.087366l-1.790955-0.831514-0.639627-0.383777a31.405679 31.405679 0 0 1-13.432164-13.688015l-0.831515-1.790955a31.981343 31.981343 0 0 1-2.36662-8.762888l-0.191888-2.046806c-6.396269-107.457314-58.653784-180.822516-160.354456-223.99733l-3.453985-1.471141-3.32606 1.471141c-101.700672 43.174814-153.958188 116.540016-160.354456 223.99733l-0.127925 2.046806a31.981343 31.981343 0 0 1-2.430582 8.762888l-0.831515 1.790955a34.98759 34.98759 0 0 1-6.588157 8.826851 31.405679 31.405679 0 0 1-6.780045 4.861164l-0.639627 0.383777-1.854918 0.831514a32.36512 32.36512 0 0 1-10.809694 2.558508l-4.157574-0.127925-4.02965-0.575665 2.558508 0.447739-2.110769-0.255851-1.279254-0.319813-2.558507-0.639627a34.220038 34.220038 0 0 1-5.94853-2.558507l-1.535105-0.959441a30.574164 30.574164 0 0 1-6.588156-5.564753l-1.599067-1.918881a31.725493 31.725493 0 0 1-5.308903-10.553843l-5.436829-17.653702c-46.88465-159.650867-23.79412-290.774375 70.486881-388.893137l0.95944 14.903306c-12.216873-152.551008 33.900224-279.516942 137.711665-378.01948 6.396269-6.012493 14.583493-8.954776 22.706754-8.762888z m0 76.88315l-2.814359 3.134171C421.307066 161.381697 390.093275 261.227451 399.815603 382.180892a32.237194 32.237194 0 0 1-9.402515 25.265262c-61.148329 58.845672-89.611724 132.402762-84.942448 222.782038 35.307403-66.265344 95.240441-115.900389 178.903636-147.753806A31.917381 31.917381 0 0 1 496.399261 480.235692a31.853418 31.853418 0 0 1 12.024985 2.110768c83.663195 31.917381 143.660195 81.552426 178.903635 147.81777 4.669276-90.315314-23.79412-163.936367-84.942448-222.782039a32.237194 32.237194 0 0 1-9.402515-25.265261c9.850254-122.488546-22.259015-223.357703-96.583657-304.718241zM495.759634 192.467563a63.962687 63.962687 0 1 1 0 127.925374 63.962687 63.962687 0 0 1 0-127.925374z" fill="#323330" p-id="1184"></path></svg>
    </div>
  </transition>
</template>

<script setup>
import { ref, onMounted, onBeforeUnmount } from 'vue';

const visibilityHeight = ref(400);
const backPosition = ref(0);
const customStyle = ref({
  right: '50px',
  bottom: '50px',
  width: '30px',
  height: '30px',
  'border-radius': '4px',
  'line-height': '45px',
  background: '#FFFFFF00',
});
const transitionName = ref('fade');

const visible = ref(false);
const interval = ref(null);
const isMoving = ref(false);

const handleScroll = () => {
  visible.value = window.pageYOffset > visibilityHeight.value;
};

const goTop = () => {
  if (isMoving.value) return;
  const start = window.pageYOffset;
  let i = 0;
  isMoving.value = true;
  interval.value = setInterval(() => {
    const next = Math.floor(easeInOutQuad(10 * i, start, -start, 500));
    if (next <= backPosition.value) {
      window.scrollTo(0, backPosition.value);
      clearInterval(interval.value);
      isMoving.value = false;
    } else {
      window.scrollTo(0, next);
    }
    i++;
  }, 16.7);
};

const easeInOutQuad = (t, b, c, d) => {
  if ((t /= d / 2) < 1) return (c / 2) * t * t + b;
  return (-c / 2) * (--t * (t - 2) - 1) + b;
};

onMounted(() => {
  window.addEventListener('scroll', handleScroll);
});

onBeforeUnmount(() => {
  window.removeEventListener('scroll', handleScroll);
  if (interval.value) {
    clearInterval(interval.value);
  }
});
</script>

<style scoped>
.back-to-ceiling {
  position: fixed;
  display: inline-block;
  text-align: center;
  cursor: pointer;
}

</style>




